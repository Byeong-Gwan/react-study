# 2025-10-22 Summary: 가위바위보 모달 UI/로직 전체 문서

이 문서는 2025-10-22 기준, 프로젝트 내 가위바위보 기능의 구조, 상태 흐름, 스타일 설계, 변경 내역(티끌까지)을 모두 기록한 문서입니다.

** 참고 내용 **
- 내용 정리하여 보기 좋게 정렬 처리를 위해 Chat GPT 사용
- CSS 스타일 부분 약해서 검색으로 찾아보고 색상, 모바일 전환 방법 등 구글링을 통해 찾아봤으며,
  도저히 모르는 거는 Chat GPT로 찾아봤음

** 개선 요소 ** 
- CSS 스타일 부분 약함 
- 각 속성 별 의미 정리 공부 예정
- 추후 중복 된 로직 개선 예정

---

- 프로젝트 경로: `react/scissors_rock_paper_play/`
- 주요 파일
  - `src/App.jsx` — 게임 상태/로직/모달 및 컨트롤 UI 구성
  - `src/component/Box.jsx` — 단일 카드(You/Computer) 표시 컴포넌트
  - `src/App.css` — 전반 UI 스타일(모달/카드/버튼/결과/도트/반응형)

---

## 1. App.css: 스타일(클래스)별 목적과 주요 속성

### 1.1 레이아웃/컨테이너
- **`.overlay`**: 화면 전체를 덮는 모달 배경(딤)
  - 목적: 배경 비활성화, 포커스 유도, 스크롤 가능
  - 속성: `position: fixed; inset: 0; background: rgba(2,6,23,0.6); backdrop-filter: blur(1px); z-index: 9999; display: flex; align-items: center; justify-content: center; padding: 16px; overflow: auto; pointer-events: auto;`

- **`.modal`**: 모달 외부 컨테이너
  - 목적: 중앙 정렬과 최대 너비 제어(컴팩트)
  - 속성: `position: relative; width: 100%; max-width: 560px; background: transparent; pointer-events: auto;`

- **`.modal-inner`**: 모달 실제 카드(콘텐츠 래퍼)
  - 목적: 흰 배경, 라운드, 그림자, 내부 스크롤(내용 많을 때)
  - 속성: `background: #fff; border-radius: 12px; padding: 16px 16px 20px; box-shadow: 0 20px 40px rgba(15,23,42,0.28), 0 2px 6px rgba(15,23,42,0.1); max-height: 80vh; overflow: auto;`

- **`.modal-close`**: 왼쪽 상단 ‘X’ 닫기 버튼
  - 목적: 스크린샷과 동일한 왼쪽 상단 배치
  - 속성: `position: absolute; top: -8px; left: -8px; background: #fff; color: #0f172a; border: 1px solid #e2e8f0; border-radius: 10px; width: 36px; height: 36px; box-shadow: 0 6px 16px rgba(15,23,42,0.12); cursor: pointer;`

### 1.2 제목/배지/오픈 버튼
- **`.app-title`**: 모달 내부 타이틀 중앙정렬/간격
- **`.badge`**: 보조 설명 배지(연한 배경/보더)
- **`.open-game-btn`**: 모달 오픈 버튼(짙은 배경, 라운드, hover 컬러)

### 1.3 카드 그리드/반응형
- **`.cards`**: 두 카드(You/Computer) 배치
  - 2열 그리드: `display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 12px; align-items: start;`
  - 반응형: `@media (max-width: 640px) { .cards { grid-template-columns: 1fr; } }` (모바일 세로 스택)

- **`.box`**: 카드 공통 스타일
  - 속성: `border: 1px solid #e2e8f0; border-radius: 10px; padding: 12px; background: #fff; box-shadow: 0 6px 16px rgba(15,23,42,0.08); box-sizing: border-box;`

- **`.item-img`**: 카드 이미지
  - 속성: `width: 100%; max-height: 180px; object-fit: contain;` (과대 방지)

### 1.4 결과 텍스트 강조
- **`h2 { height: 39px; }`**: 결과 영역 고정 높이로 레이아웃 안정화
- **`.result`**: 결과 텍스트 공통 스타일
  - 속성: 중앙정렬, 굵기, 자간, 최소 높이, 컬러/트랜지션
- **`.result.win` / `.result.lose` / `.result.tie` / `.result.idle`**
  - win: 초록, lose: 빨강, tie: 중간톤, idle: 회색(시작 전)

### 1.5 승점 도트(라운드 승수 시각화)
- **`.dots`**: 도트 컨테이너(중앙 정렬, gap 8px)
- **`.dot`**: 기본 회색 도트(12px, 살짝 인셋 보더)
- **`.dot.filled`**: 승리 시 초록으로 채움 + 살짝 확대 + 은은한 글로우

### 1.6 버튼 행
- **`.button-row`**: 가위/바위/보/초기화 버튼 행 (한 줄 배치)
- **`.button-row button` + `.modal-inner .button-row button`**
  - 전역 100% 폭 스타일을 무시하고 `width: auto !important`로 가로 배치를 강제
  - `min-width: 64px`로 버튼 최소 너비 보장

### 1.7 승자 카드 강조
- **`.match-winner`**: 최종 승자 카드 하이라이트
  - 속성: 진한 초록 테두리/그림자, `winner-pop` 애니메이션으로 살짝 튀어나오는 느낌
- **`@keyframes winner-pop`**: 0.98 → 1.0 스케일 팝 효과(240ms)

---

## 2. App.jsx: 상태/상수/함수/렌더링 조건

### 2.1 상수: `choice`
```js
const choice = {
  scissors: { name: 'Scissors', img: scissors },
  rock: { name: 'Rock', img: rock },
  paper: { name: 'Paper', img: paper },
}
```

### 2.2 상태(State)
- `userSelect: object|null`
  - 사용자가 낸 최근 선택(이미지/이름). 초기 `null`.
- `computerSelect: object|null`
  - 컴퓨터 랜덤 선택. 초기 `null`.
- `result: { user: string, computer: string }`
  - 최근 라운드 결과. 초기 `{ user: '', computer: '' }` → 시작 전 `idle` 처리 용이.
- `open: boolean`
  - 모달 열림 여부.
- `format: 'bo3' | 'bo5'`
  - 경기 형식.
- `roundsTotal: number`
  - `format`로부터 파생: 3 또는 5 (도트 개수).
- `roundsToWin: number`
  - `format`로부터 파생: 2 또는 3 (필요 승수).
- `userWins: number`, `computerWins: number`
  - 누적 라운드 승수.
- `matchWinner: 'user' | 'computer' | null`
  - 매치 승자. 결정 후 버튼 비활성화.

### 2.3 함수(로직)
- `randomChoice()`
  - `['scissors','rock','paper']` 중 랜덤 인덱스로 선택.

- `jugement(userObj, computerObj)` → `{ user: 'win|lose|tie', computer: 'win|lose|tie' }`
  - 규칙: 같으면 `tie`, 가위>보, 바위>가위, 보>바위.
  - 반환: `user` 기준 결과와 그 반대의 `computer` 결과.

- `play(userChoice)`
  - 가드: `if (matchWinner) return;` (매치 종료 시 무시)
  - 흐름:
    1) `userChoiceObj = choice[userChoice]`; `setUserSelect(userChoiceObj)`
    2) `computerChoice = randomChoice()`; `setComputerSelect(computerChoice)`
    3) `r = jugement(userChoiceObj, computerChoice)`; `setResult(r)`
    4) 승수 증가:
       - `r.user === 'win'` → `userWins + 1` → `roundsToWin` 도달 시 `setMatchWinner('user')`
       - `r.user === 'lose'` → `computerWins + 1` → `roundsToWin` 도달 시 `setMatchWinner('computer')`

- `resetGame()`
  - 모든 상태 초기화:
    - `userSelect=null`, `computerSelect=null`
    - `result={ user: '', computer: '' }`
    - `userWins=0`, `computerWins=0`, `matchWinner=null`

### 2.4 렌더링 조건/속성
- 모달 열기/닫기: `{open && <div className='overlay'>...}` / ‘X’ 버튼으로 닫기
- 경기 형식 변경: `<select value={format} onChange={(e)=>{ setFormat(e.target.value); resetGame(); }}>`
- 플레이 버튼 비활성화: `disabled={!!matchWinner}` (승자 결정 후 입력 차단)
- 카드에 전달되는 props:
  - `title`, `item`, `result`, `wins`, `totalDots`, `isMatchWinner`

---

## 3. Box.jsx: 표시 로직과 조건

```jsx
function Box(props) {
  const res = props.result || { user: '', computer: '' };
  const result = props.title === 'Computer' ? res.computer : res.user;
  const wins = props.wins ?? 0;
  const totalDots = props.totalDots ?? 3;
  const isMatchWinner = !!props.isMatchWinner;

  return (
    <div>
      <div className={`box${isMatchWinner ? ' match-winner' : ''}`}>
        <h1>{props.title}</h1>
        <img className='item-img' src={props.item && props.item.img} alt={props.item && props.item.img} />
        <h2 className={`result ${result || 'idle'}`}>{result}</h2>
         <div className='dots'>
            {Array.from({ length: totalDots }).map((unused, dotIndex) => (
                <span
                    key={dotIndex}
                    className={`dot${dotIndex < wins ? ' filled' : ''}`}
                    aria-label={`round-dot-${dotIndex + 1}${dotIndex < wins ? '-filled' : ''}`}
                ></span>
            ))}
        </div>
      </div>
    </div>
  )
}
```

- **결과 텍스트 클래스 부여**: `result`가 빈 문자열이면 `idle`을 적용해 시작 전 상태를 회색으로 표시.
- **도트 렌더링**: `totalDots` 길이로 도트 생성, `wins`보다 작은 인덱스는 `filled`로 채움.
- **매치 승자 강조**: `isMatchWinner`가 `true`면 `box`에 `match-winner` 클래스를 추가.

---

## 4. 변경 이력(요약)

- 모달 UI 추가(오버레이/내부 스크롤, 왼쪽 상단 X 닫기)
- 레이아웃 개선: Flex → Grid(2열) + 모바일 1열
- 버튼 가로 배치 강제 및 전역 폭 스타일 무력화
- 이미지/결과/도트 시각 강화(과대 방지, 컬러/애니메이션)
- 게임 형식(3판 2승/5판 3승) 도입 → 도트 개수/필요 승수 동기화
- 승수 집계 및 매치 승자 상태/강조 추가
- 초기화 로직(형식 변경 시 포함)
- 안정성: `result`를 객체 초기값으로, Box에서 방어적 접근
- `play()` 내 `jugement()` 중복 호출 제거

---

## 5. 테스트 체크리스트

- 형식 변경 시 도트 개수와 필요 승수가 즉시 반영되는가?
- 결과 텍스트가 `win/lose/tie/idle`에 맞는 색으로 표시되는가?
- 각 라운드 승리 시 도트가 왼쪽부터 초록으로 채워지는가?
- 누군가 `roundsToWin`에 도달하면 버튼이 비활성화되고 승자 카드가 강조되는가?
- ‘초기화’ 버튼 또는 형식 변경 시 모든 상태가 리셋되는가?

---

## 6. 추가 개선 아이디어(선택)

- 오버레이 클릭/ESC로 닫기, 포커스 트랩(A11y), 배경 스크롤 잠금
- 승자 리본 배지, 효과음, 난이도 조절(가중 랜덤)
- E2E/유닛 테스트 (결과 판정/승수 로직)

---

## 7. 코드 스니펫 모음

### 7.1 결과 판정
```js
const jugement = (user, computer) => {
  let userResult = '';
  if (user.name === computer.name) userResult = 'tie';
  else if (user.name === 'Scissors') userResult = computer.name === 'Paper' ? 'win' : 'lose';
  else if (user.name === 'Rock') userResult = computer.name === 'Scissors' ? 'win' : 'lose';
  else if (user.name === 'Paper') userResult = computer.name === 'Rock' ? 'win' : 'lose';
  const computerResult = userResult === 'win' ? 'lose' : userResult === 'lose' ? 'win' : 'tie';
  return { user: userResult, computer: computerResult };
};
```

### 7.2 한 라운드 진행
```js
const play = (userChoice) => {
  if (matchWinner) return;
  const userChoiceObj = choice[userChoice];
  setUserSelect(userChoiceObj);
  const computerChoice = randomChoice();
  setComputerSelect(computerChoice);
  const r = jugement(userChoiceObj, computerChoice);
  setResult(r);
  if (r.user === 'win') setUserWins(p => { const n = p + 1; if (n >= roundsToWin) setMatchWinner('user'); return n; });
  else if (r.user === 'lose') setComputerWins(p => { const n = p + 1; if (n >= roundsToWin) setMatchWinner('computer'); return n; });
};
```

### 7.3 초기화
```js
const resetGame = () => {
  setUserSelect(null);
  setComputerSelect(null);
  setResult({ user: '', computer: '' });
  setUserWins(0);
  setComputerWins(0);
  setMatchWinner(null);
};
```

---

문서 끝.
